\documentclass{article}

\usepackage[separate-uncertainty=true]{siunitx}
\usepackage{graphicx}
\usepackage{amsmath}
\usepackage{bm,upgreek}
\usepackage[colorlinks,colorlinks,linkcolor=blue]{hyperref}
\usepackage[capitalise,noabbrev,nameinlink]{cleveref}
\usepackage{caption}
\usepackage{subcaption}
\usepackage{graphicx}
\usepackage{booktabs}

\title{Analysis of Coupled Oscillators through Fourier Methods}
\author{Raymond Langehennig}

\begin{document}
\maketitle

% \begin{abstract}
%   test
% \end{abstract}

\section{Introduction}

\subsection{Coupled and driven oscillators}
When a system exhibiting oscillatory motion (an oscillator) is subjected to a periodic, external force, it is known as a \emph{driven oscillator}. Driven oscillators exhibit a behavior known as \emph{resonance} when the frequency of the external force matches the oscillatory frequency of the system, at which point the amplitude of oscillation may increase dramatically, depending on how damped the system is.

A \emph{coupled oscillator} is a system with multiple oscillatory elements that influence each other in some way. This could be something like two pendulums connected by a spring, or the atoms of a metal connected by electromagnetism. For such a system, an arbitrary displacement from equilibrium usually results in complicated motion where the frequency at which each element oscillates itself continuously oscillates; however, coupled oscillators are capable of certain so-called \emph{normal modes} of motion, where each element oscillates at the same, fixed frequency. The number of different normal modes is equal to the number of degrees of freedom. This can be seen in the example of the two spring-coupled pendulums, for which there are two normal modes: the first when the two pendulums are given the same initial displacement in the same direction, and the second when they are given the same displacement but in opposite directions. When a coupled oscillator is driven, resonance may be achieved at the frequency of any one of these normal modes.

\subsection{Objective}
The subject of study in this report is a magnetically coupled, magnetically driven, torsional oscillator, and the object is to observe and analyze its motion with an oscilloscope and ultimately a fast Fourier transform spectrum analyzer, in order to find the frequencies of the normal modes. The phenomenon of the avoided crossing will also be observed.

\begin{figure}
  \centering
  \includegraphics[width=\linewidth]{20250910_113924.jpg}
  \caption{Photo of the torsional oscillator used.}
  \label{fig:oscillator}
\end{figure}

\section{Model}\label{sec:model}
The oscillator consists of two phosphor-bronze reeds in-line with each other, clamped on the outer ends and with a magnetic neodymium cube either inner end. These magnets are placed inside vertical coils that allow for either excitation or detection, and both reeds are placed inside horizontal coils meant for tuning the entire system.
This setup means that there are two normal modes of oscillation, one where the reeds twist in phase and one where they twist completely out of phase. The frequencies of these normal modes may be predicted theoretically, after which they will be compared to experimental values.

\subsection{Resonsant frequency of a single reed}\label{sec:icalc}
The resonant frequency of a single, untuned reed can be calculated easily by $\omega = \sqrt{\kappa/I}$. $\kappa$ may be calculated using \[ \kappa = G\frac{wt^3}{3L}, \] where $G = \qty{41}{\giga\pascal}$ is the shear modulus, $w = \qty{6.35}{\mm}$ is the width of the reed, $t = \qty{0.254}{\mm}$ is the thickness or depth of the reed, and $L = \qty{100}{\mm}$ is the length of the reed, all giving $\kappa \approx \qty{0.014}{N.m}$. The rotational inertia of the cube $I = \rho\ell^5/6 \approx \qty{0.129}{\gram.\cm^2}$, with a density $\rho = \qty{7.51}{g/cm^3}$ and side length $\ell = \qty{6.35}{mm}$. This gives $\omega = \qty{1050}{\per\s}$ and therefore a resonant frequency $f = \qty{167}{Hz}$.

This is also one of the two resonant frequencies of the entire two-reed system (with no tuning), as will be shown in the derivation of the second resonant frequency, but which may also be seen from inspection.

\subsection{Resonant frequencies of the entire system}
Finding the resonant frequency of the second normal mode is a lot more involved. It entails finding the total potential energy of the entire system, with contributions from the torsion of the reeds, the tuning coils, and the interaction between the magnets, finding and finally solving the equations of motion of the system for the resonant frequencies.
\subsubsection{Tuning}
The tuning coils induce a magnetic field perpendicular to the axis of the reeds---in other words, if a coordinate system is given where $x$ is parallel to the reeds, $z$ is perpendicular to the ground, and $y$ is perpendicular to $x$ and $z$, the tuning field $B_\text{T}$ is in the $y$ direction. The tuning field effectively changes the torsion constant by adding a term to the potential energy
\begin{equation*}
  \begin{aligned}
    U   &= U_\tau + U_T \\
    &= \kappa\theta^2/2 - \bm{\upmu}\cdot\mathbf{B}_T \\
    &= \kappa\theta^2/2 - \mu B_\text{T} \cos \theta \\
    &\approx \kappa\theta^2/2 - \mu B_\text{T} (1-\theta^2/2) \\
    &= (\kappa+\mu B_\text{T})\theta^2/2 - \mu B_\text{T},
  \end{aligned}
\end{equation*}
where $\bm{\upmu}$ is the magnet's dipole. The new angular frequency can then be derived:
\begin{equation*}
  \begin{aligned}
    I \ddot{\theta} &= \tau = -\frac{\mathrm{d}U}{\mathrm{d}\theta} \\
    &= -(\kappa + \mu B_\text{T})\theta \\
    &= -\omega^2 \theta \\
    \implies \omega &=  \sqrt{\frac{\kappa + \mu B_\text{T}}{I}}.
  \end{aligned}
\end{equation*}
If both reeds are considered, then they have two different frequencies,
\begin{equation*}
  \omega_1 = \sqrt{\frac{\kappa_1 + \mu_1 B_\text{T}}{I}}\quad\text{and}\quad\omega_2 = \sqrt{\frac{\kappa_2 - \mu_2 B_\text{T}}{I}},
\end{equation*}
where it is assumed the reeds have different torsional constants and dipole moments, and the negative in the second is because its magnet's moment is opposite that of the first.

\subsubsection{Coupling}
The interaction between the magnets may be modelled by considering the magnetic field at one of the two magnets due to the other, separated by a distance $\mathbf{r}$:
\begin{equation*}
  \mathbf{B}_1(\mathbf{r}) = \frac{\mu_0}{4\pi}\left( 3\frac{\bm{\upmu}_1\cdot\mathbf{r}}{r^5}\mathbf{r} - \frac{\bm{\upmu}_1}{r^3} \right),
\end{equation*}
from which arises a magnetic potential energy
\begin{equation*}
  \begin{aligned}
    U_B &= -\bm{\upmu}_2\cdot \mathbf{B}_1(\mathbf{r}) \\
    &= \frac{\mu_0}{4\pi}\left( -3\frac{(\bm{\upmu}_1\cdot\mathbf{r})(\bm{\upmu}_2\cdot\mathbf{r})}{r^5}\mathbf{r} + \frac{\bm{\upmu}_1\cdot\bm{\upmu}_2}{r^3} \right) \\
    &= \frac{\mu_0}{4\pi}\frac{\bm{\upmu}_1\cdot\bm{\upmu}_2}{r^3} \\
    &= -\frac{\mu_0}{4\pi}\frac{\mu_1\mu_2}{r^3}\cos(\theta_1 - \theta_2) \\
    &\approx -\frac{\mu_0}{4\pi}\frac{\mu_1\mu_2}{r^3} \left( 1 - \frac{(\theta_1 - \theta_2)^2}{2} \right)
  \end{aligned}
\end{equation*}
where the $\bm{\upmu}\cdot \mathbf{r}$ terms have gone to 0 as the two vectors are always perpendicular, and the small angle approximation has been applied to the cosine.

\subsubsection{Equations of motion}
The equation for the total potential energy, using the results of the previous sections, can be written
\begin{equation*}
  U = \frac{1}{2}\kappa\theta_1^2 + \frac{1}{2}\kappa\theta_2^2+ \frac{1}{2}\mu B_\text{T}\theta_1^2 + \frac{1}{2}\left( -\mu B_\text{T} \right)\theta_2^2 + \frac{1}{2}\left( -\frac{\mu_0}{4\pi}\frac{\mu^2}{r^3} \right)\left( \theta_1 - \theta_2 \right)^2,
\end{equation*}
where constant terms have been omitted (so that $U=0$ at some point) and the dipole moments and torsion spring constants are assumed to be equal in magnitude.
The coefficient in the last term, $-\frac{\mu_0}{4\pi}\frac{\mu^2}{r^3} := \lambda$, describes the strength of the magnetic coupling and comes out to about \qty{0.0008}{N.m} in magnitude for an $r$ of \qty{20}{mm}.

The equations of motion can now be derived:
\begin{equation*}
  \begin{cases}
    I\ddot{\theta}_1 &= -\frac{\partial U}{\partial \theta_1} + \mu k_z i_1 \\
    I\ddot{\theta}_2 &= -\frac{\partial U}{\partial \theta_2} + \mu k_z i_2
  \end{cases}
\end{equation*}
where $i_1$ and $i_2$ are the currents through the driving coils, and $k_z \approx \qty{6.6}{mT/A}$ gives the driving field strength generated by a current. These equations can be rewritten as
\begin{equation*}
  \begin{cases}
    I\ddot{\theta}_1 + (\kappa + \mu B_\text{T})\theta_1 + \lambda(\theta_1 - \theta_2) &= \mu k_z i_1\\
    I\ddot{\theta}_2 + (\kappa - \mu B_\text{T})\theta_2 + \lambda(\theta_2 - \theta_1) &= \mu k_z i_2
  \end{cases}
\end{equation*}
which are seen to be coupled differential equations.

This system of equations may be simplified by assuming the conditions the normal mode in the undriven case, where both currents are set to 0 and the system oscillates at $\omega$:
\begin{equation*}
  \begin{cases}
    \theta_1(t) &= A_1 \exp(-i\omega t) \\
    \theta_2(t) &= A_2 \exp(-i\omega t)
  \end{cases}
\end{equation*}
The coupled differential equations, now a linear system of equations, may be written in matrix form:
\begin{equation*}
  \left[
    \begin{matrix}
      -I\omega^2+(\kappa + \mu B_\text{T} + \lambda)   &   -\lambda \\
      -\lambda                                    &   -I\omega^2+(\kappa - \mu B_\text{T} + \lambda)
  \end{matrix} \right]\left[
    \begin{matrix} A_1 \\ A_2
  \end{matrix} \right] = \left[
    \begin{matrix} 0\\0
  \end{matrix} \right].
\end{equation*}
For this equality to hold, either there is only the trivial solution where $A_1=A_2=0$, or there exists a nontrivial solution. The latter is true if and only if the determinant of the square matrix is 0.
This nontrivial case may be assumed by the fact the system exhibits oscillation, which implies
\begin{equation*}
  \begin{aligned}
    \left|
    \begin{matrix}
      -I\omega^2+(\kappa + \mu B_\text{T} + \lambda)   &   -\lambda \\
      -\lambda                                    &   -I\omega^2+(\kappa - \mu B_\text{T} + \lambda)
    \end{matrix} \right| &= 0 \\
    = I^2 \omega^4 + \left(-2I\kappa-2I\lambda \right)\omega^2 + \left(\kappa^2 + 2\kappa\lambda - (\mu B_\text{T})^2\right) &= 0,
  \end{aligned}
\end{equation*}
which is an easily solvable, biquadratic equation yielding
\begin{equation}
  \omega_\pm = \sqrt{\frac{\kappa+\lambda \pm \sqrt{\lambda^2 + \left(\mu B_\text{T}\right)^2}}{I}},\label{eq:omegar}
\end{equation}
where the negative solutions have been omitted.

\subsubsection{The avoided crossing}
The solutions for $\omega$ predict the phenomenon of the \emph{avoided crossing}, where, when they are plotted against current through the tuning coils, the resonant frequencies of the system appear to avoid overlapping as $B_\text{T}$ is varied.

If the system were to be manually uncoupled, that is to say, if one of the reeds was allowed to oscillate while the other was held fixed at its equilibrium position, then the reed whose dipole is aligned with $B_\text{T}$ oscillates with a frequency $\Omega_1 = \sqrt{\frac{\kappa+\mu B_\text{T}+\lambda}{I}}$, and the other reed with a frequency $\Omega_2 = \sqrt{\frac{\kappa-\mu B_\text{T}+\lambda}{I}}$. If these are then plotted, no such phenomenon is observed, as it is a feature of coupled oscillators only. In fact, the $\omega$ curves appear to have the $\Omega$ curves as asymptotes. Such a plot may be seen in \autoref{fig:fvsi}.

\section{Materials and Procedure}
The experiment centered around the oscillator that is part of the TeachSpin Fourier Methods apparatus (seen in \autoref{fig:oscillator}, circuit diagram in \autoref{fig:circuitdiagram}). Most of the details concerning its functioning have been stated in \autoref*{sec:model}.

\begin{figure}
  \centering
  \begin{subfigure}{.45\textwidth}
    \centering
    \includegraphics[width=.8\linewidth]{setup.jpg}
    \caption{Photo of experiment layout. Oscillocope and function generator on the right.}
    \label{fig:setupphoto}
  \end{subfigure}
  \begin{subfigure}{.45\textwidth}
    \centering
    \def\svgwidth{\linewidth}
    \input{circuit.pdf_tex}
    \caption{Circuit diagram of the TeachSpin coupled oscillator.}
    \label{fig:circuitdiagram}
  \end{subfigure}
  \caption{}
  \label{setup}
\end{figure}

The current induced in the driving coils was at first read on a RIGOL DS1104Z oscilloscope, with excitations provided by a RIGOL DG1022Z function generator (\autoref{fig:setupphoto}), and later both read and excited by an SRS SR770 FFT Network Analyzer (\autoref{fig:fft}).

\begin{figure}
  \centering
  \includegraphics[width=\linewidth]{SR770_FPlg.jpg}
  \caption{Front panel of the SR770 FFT analyzer.}
  \label{fig:fft}
\end{figure}

\subsection{Experimentation with oscilloscope}
The reeds of the oscillator were first given a small, lateral displacement to confirm that they were in fact magnetically coupled and could move with minimal friction. The oscillator was configured as seen in \autoref{setup}, and one of the reeds twisted manually to check that the current was being read properly. The function generator was set to produce a \qty{1}{V_{pp}} sinusoidal signal, whose frequency was varied from \qtyrange{100}{200}{Hz} in order to find the resonant frequencies of the system, characterized by extreme amplitude and phase difference.
\begin{figure}
  \centering
  \includegraphics[width=.5\linewidth]{resfreq154.jpg}
  \caption{The first normal mode of the system, as seen on the oscilloscope.}
\end{figure}

After the resonant frequencies were found, the behavior of the system from \qtyrange{150}{170}{Hz} was investigated. The amplitude of channel 3 and the time difference between the signals from the coils was recorded every \qty{5}{Hz} (\autoref{tab:oscfa}).

\subsection{Experimentation with SR770}\label{sec:fftproc}
The principle by which the SR770 works is simple: the system is excited by a signal that can be considered a superposition of sinusoids across a continuous range of frequencies, and by Fourier analysis, the amplitude of oscillation that each frequency induces is obtained. Two kinds of signals were used: noise, which is a superposition of all sinusoids from \qtyrange{0}{100}{kHz}, and chirp, which is a superposition of sinusoids belonging only to a range of interest. For the following procedures, noise was used only briefly as the and no data was recorded, as chirp excitations have far less noisy results owing to its more focused range.

\begin{figure}
  \centering
  \includegraphics[width=.5\linewidth]{sr770.png}
  \caption{SR770 FFT analyzer with power supply.}
\end{figure}

The process for configuring the SR770 is similar to that for the oscilloscope. Excitation signals are sent to one of the driving coils through the \qty{1}{k\ohm} resistor from the SOURCE OUT plug of the SR770, and current from the other coil is sent to input A of the SR770. No current was supplied to the tuning coils.

Resonances between \qty{100.0977}{Hz} and \qty{197.5977}{Hz} over 100 averages were noted (\autoref{tab:sr770res}).

Current was then supplied to the tuning coils. Over the same range of frequencies, using 300 averages, the resonant frequencies of the system were recorded as the current was varied from \qtyrange{-2}{2}{\ampere} in \qty{0.2}{\ampere} intervals.

\section{Results}

\subsection{Calculation of $\kappa$ and $\lambda$ from experimental data}
Assuming no current, \autoref{eq:omegar} reduces to
\begin{equation*}
	\omega_\pm = \sqrt\frac{\kappa+\lambda \pm \lambda}{I}
\end{equation*}
from which, using the value for $I$ calculated in \autoref{sec:icalc}, a more accurate figure for $\kappa$ and $\lambda$ may be recovered. For $\omega_- = 2\pi\qty{154.79 \pm 0.23}{Hz} = \qty{972.6 \pm 1.4}{s^{-1}}$ and $\omega_+ = 2\pi\qty{167.24 \pm 0.23}{Hz} = \qty{1050.8 \pm 1.4}{s^{-1}}$, a value of \qty{0.01220 \pm 0.00004}{N.m} for $\kappa$ and \qty{0.001021 \pm 0.000028}{N.m} for $\lambda$ are obtained.

\subsection{Oscilloscope data}
The resonant frequencies were measured to be \qty{154.49}{Hz} and \qty{167.30}{Hz} on the oscilloscope. Uncertainty in the frequency as set on the function generator is given as $\pm\qty{1}{ppm}$, and the uncertainty in the time difference is given by a combination of resolution uncertainty ($1/(2\times\text{sample rate})$) and timebase inaccuracy ($\pm\qty{25}{ppm}$):  $\delta(\Delta t) = \sqrt{\left( \qty{4}{ns} \right)^2 + \left( \qty{25}{ppm} \Delta t \right)^2}$.
Phase difference was calculated via $\phi = 2\pi f \Delta t$.

\begin{table}
  \centering
  \caption{Phase difference and amplitude around the resonant frequencies of the untuned system.}
  \begin{tabular}{@{}rrrr@{}}
    \toprule
    $f$ (\unit{Hz}) & $A$ (\unit{\mV}) & $\phi$ ($^\circ$) & $\delta\phi$ ($^\circ$) \\ \midrule
    150.00    & 3.2      &77.76 & 1.96    \\
    154.49   & 9.0      & 17.80 & 0.50   \\
    154.72   & 52.4     & 3.34 & 0.24   \\
    155.00    & 14.2     &13.39 & 0.40    \\
    160.00    & 3.0      &94.46 & 2.37    \\
    165.00    & 3.8      &125.93 & 3.16    \\
    167.32   & 19.6     & 178.30 & 4.47   \\
    170.00    & 3.4      &127.30 & 3.19    \\ \bottomrule
  \end{tabular}
  \label{tab:oscfa}
\end{table}

\subsection{SR770 data}
The horizontal resolution of the SR770 as reported by its manufacturer is equal to $\text{span}/400=\qty{0.24375}{Hz}$ which dominates the uncertainty of the frequency measurements (compare, for example, with the reported accuracy of \qty{25}{ppm}). The uncertainty in amplitude, on the entire hand, is determined by accuracy, which is given as $\pm\qty{0.3}{dB}\pm (0.02\%\text{ of full scale})$. The decibel uncertainty may be expressed as an (asymmetric) percent uncertainty:
\begin{equation*}
  \begin{aligned}
    \pm 0.3 &= 20 \log_{10}\left( 1 + \delta_\text{dB}V/V \right) \\
    \implies \delta_\text{dB}V/V &= 1- 10^{(\pm0.3/20)} = ^{+3.51\%}_{-3.40\%}%\\
    %     &\approx \pm 3.5\
    ,
  \end{aligned}
\end{equation*}
and the full scale uncertainty for a $V_\text{top}=\qty{199.526}{mV}$ comes out to $\pm \qty{0.0399052}{mV}$, giving a combined uncertainty of
\begin{equation*}
  \delta V = \sqrt{\left( \qty{0.0399052}{mV} \right)^2 + \left( ^{+3.51\%}_{-3.40\%} V \right)^2}.
\end{equation*}
For the sake of brevity, this uncertainty is approximated with a symmetrical uncertainty in \autoref{tab:sr770res}.

\autoref{fig:fvsi} is a plot of the resonant frequencies against current.

\begin{table}
  \centering
  \caption{Untuned resonant frequencies as measured on the SR770.}
  \begin{tabular}{@{}cl@{}}
    \toprule
    $f$ (\unit{Hz}) & $A$ (\unit{mV}) \\
    $\pm$ 0.24 & \\
    \midrule
    117.67 & $0.03 \pm 134\%$ \\
    120.36 & $0.08 \pm 50\%$ \\
    154.78 & $1.52 \pm 4\%$ \\
    167.48 & $0.54 \pm 8\%$ \\
    \bottomrule
  \end{tabular}
  \label{tab:sr770res}
\end{table}

\begin{figure}
  \centering
  \def\svgwidth{\linewidth}
  \input{avoided_crossing.pdf_tex}
  \caption{$f_-$ and $f_+$ vs. current.}
  \label{fig:fvsi}
\end{figure}

\begin{figure}
  \centering
  \begin{subfigure}{.5\linewidth}
    \def\svgwidth{\linewidth}
    \input{omegasum.pdf_tex}
  \end{subfigure}%
  \begin{subfigure}{.5\linewidth}
    \def\svgwidth{\linewidth}
    \input{omegadiff.pdf_tex}
  \end{subfigure}
  \caption{Sum and difference of $\omega_+^2$ and $\omega_-^2$ vs. current.}
  \label{fig:omegagraphs}
\end{figure}

\section{Discussion}
While the values for positive current agree within uncertainty, \cref{fig:fvsi,fig:omegagraphs} show a clear deviation in the experimental values from the expected values for negative current that cannot be accounted for. In fact, the measurements were repeated a different day to largely the same effect (\autoref{fig:graphs1022}).

This deviation may be attributable to other normal modes of the system. \autoref{tab:sr770res} shows at least one resonant frequency within \qty{50}{Hz} from the frequencies studied in this experiment when there is no tuning field present, though what normal mode this could represent is uncertain.

It should also be noted that damping was largely neglected in the model for this experiment, and no attempts were made to quantify it.



% damping
% the negative current bit
% other normal modes

\begin{figure}
  \centering
  \begin{subfigure}{\linewidth}
	\def\svgwidth{\linewidth}
  \input{avoided_crossing1022.pdf_tex}
  \end{subfigure}
  \begin{subfigure}{.5\linewidth}
    \def\svgwidth{\linewidth}
    \input{omegasum1022.pdf_tex}
  \end{subfigure}%
  \begin{subfigure}{.5\linewidth}
    \def\svgwidth{\linewidth}
    \input{omegadiff1022.pdf_tex}
  \end{subfigure}
  \caption{Results of repeating the procedure of \autoref{sec:fftproc} on a different day.}
  \label{fig:graphs1022}
\end{figure}

\section{Conclusion}
The resonant frequencies obtained with the SR770 differ from those obtained with the oscilloscope by 0.1\% (for both frequencies), and from those predicted by the model (\qtylist{156;165}{Hz}) by 1\% (at most).
For future experiments, more should be done to limit or quantify the degrees of freedom of the system. Attempts could also be made to quantify the effect of damping on the system. In any case, the behavior of the system for negative currents should be more thoroughly investigated and accounted for.
% difference between oscilloscope and foart


\end{document}